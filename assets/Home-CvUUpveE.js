import{S as le,o as Ee,a as Ne,s as ee,b as Ae,c as i,U as Y,g as oe,d as e,e as de,f as Le,h as Te,i as je,j as De,p as Me,L as Ce,P as Fe,k as Ye,u as _e,B as Ue,R as Be,l as ge,m as He,n as Qe,q as ke,r as Ge,t as Ke,v as he,w as ue,x as Ze,y as ze,z as Ve,A as we,C as Je,D as xe,E as We,F as me,G as Q,H as z,I as re,J as h,K as Se,M as m,N as w,O as c,Q as T,T as se,V as qe,W as ye,X as Xe,Y as Z,Z as $e,_ as et}from"./index-BgtLdsEZ.js";import{e as ne,s as tt,i as ve,g as at,a as rt,b as st}from"./databaseService-B3cAL40S.js";function ae(o,x=null,p){if(typeof o!="object"||o===null||le in o)return o;const j=Te(o);if(j!==Ee&&j!==Ne)return o;var d=new Map,S=je(o),I=ee(0);S&&d.set("length",ee(o.length));var R;return new Proxy(o,{defineProperty(l,t,a){(!("value"in a)||a.configurable===!1||a.enumerable===!1||a.writable===!1)&&Ae();var r=d.get(t);return r===void 0?(r=ee(a.value),d.set(t,r)):i(r,ae(a.value,R)),!0},deleteProperty(l,t){var a=d.get(t);if(a===void 0)t in l&&d.set(t,ee(Y));else{if(S&&typeof t=="string"){var r=d.get("length"),s=Number(t);Number.isInteger(s)&&s<r.v&&i(r,s)}i(a,Y),pe(I)}return!0},get(l,t,a){var E;if(t===le)return o;var r=d.get(t),s=t in l;if(r===void 0&&(!s||(E=oe(l,t))!=null&&E.writable)&&(r=ee(ae(s?l[t]:Y,R)),d.set(t,r)),r!==void 0){var y=e(r);return y===Y?void 0:y}return Reflect.get(l,t,a)},getOwnPropertyDescriptor(l,t){var a=Reflect.getOwnPropertyDescriptor(l,t);if(a&&"value"in a){var r=d.get(t);r&&(a.value=e(r))}else if(a===void 0){var s=d.get(t),y=s==null?void 0:s.v;if(s!==void 0&&y!==Y)return{enumerable:!0,configurable:!0,value:y,writable:!0}}return a},has(l,t){var y;if(t===le)return!0;var a=d.get(t),r=a!==void 0&&a.v!==Y||Reflect.has(l,t);if(a!==void 0||de!==null&&(!r||(y=oe(l,t))!=null&&y.writable)){a===void 0&&(a=ee(r?ae(l[t],R):Y),d.set(t,a));var s=e(a);if(s===Y)return!1}return r},set(l,t,a,r){var g;var s=d.get(t),y=t in l;if(S&&t==="length")for(var E=a;E<s.v;E+=1){var U=d.get(E+"");U!==void 0?i(U,Y):E in l&&(U=ee(Y),d.set(E+"",U))}s===void 0?(!y||(g=oe(l,t))!=null&&g.writable)&&(s=ee(void 0),i(s,ae(a,R)),d.set(t,s)):(y=s.v!==Y,i(s,ae(a,R)));var A=Reflect.getOwnPropertyDescriptor(l,t);if(A!=null&&A.set&&A.set.call(r,a),!y){if(S&&typeof t=="string"){var q=d.get("length"),_=Number(t);Number.isInteger(_)&&_>=q.v&&i(q,_+1)}pe(I)}return!0},ownKeys(l){e(I);var t=Reflect.ownKeys(l).filter(s=>{var y=d.get(s);return y===void 0||y.v!==Y});for(var[a,r]of d)r.v!==Y&&!(a in l)&&t.push(a);return t},setPrototypeOf(){Le()}})}function pe(o,x=1){i(o,o.v+x)}function be(o){for(var x=de,p=de;x!==null&&!(x.f&(Ue|Be));)x=x.parent;try{return ge(x),o()}finally{ge(p)}}function ie(o,x,p,j){var W;var d=(p&He)!==0,S=!Qe||(p&ke)!==0,I=(p&Ge)!==0,R=(p&ze)!==0,l=!1,t;I?[t,l]=De(()=>o[x]):t=o[x];var a=le in o||Ke in o,r=((W=oe(o,x))==null?void 0:W.set)??(a&&I&&x in o?v=>o[x]=v:void 0),s=j,y=!0,E=!1,U=()=>(E=!0,y&&(y=!1,R?s=_e(j):s=j),s);t===void 0&&j!==void 0&&(r&&S&&Me(),t=U(),r&&r(t));var A;if(S)A=()=>{var v=o[x];return v===void 0?U():(y=!0,E=!1,v)};else{var q=be(()=>(d?he:ue)(()=>o[x]));q.f|=Ce,A=()=>{var v=e(q);return v!==void 0&&(s=void 0),v===void 0?s:v}}if(!(p&Fe))return A;if(r){var _=o.$$legacy;return function(v,P){return arguments.length>0?((!S||!P||_||l)&&r(P?A():v),v):A()}}var g=!1,u=!1,L=Ze(t),F=be(()=>he(()=>{var v=A(),P=e(L);return g?(g=!1,u=!0,P):(u=!1,L.v=v)}));return d||(F.equals=Ye),function(v,P){if(Ve!==null&&(g=u,A(),e(L)),arguments.length>0){const B=P?e(F):S&&I?ae(v):v;return F.equals(B)||(g=!0,i(L,B),E&&s!==void 0&&(s=B),_e(()=>e(F))),v}return e(F)}}var nt=m('<li class="svelte-g9x8pv"><p class="question-text svelte-g9x8pv"> </p> <p class="answer-text svelte-g9x8pv"> </p></li>'),vt=m('<ul class="svelte-g9x8pv"></ul>'),it=m('<p class="no-answers svelte-g9x8pv">No answers for this topic</p>'),lt=m('<div class="result-card svelte-g9x8pv"><h2 class="svelte-g9x8pv"> </h2> <div class="percentage-bar svelte-g9x8pv"><div class="percentage-fill svelte-g9x8pv"></div></div> <p class="percentage-text svelte-g9x8pv"> </p> <p class="points-text svelte-g9x8pv"> </p> <div class="answers-section svelte-g9x8pv"><h3 class="svelte-g9x8pv">Supporting Answers:</h3> <!></div></div>'),ot=m('<p class="svelte-g9x8pv">You are most suited for <strong class="svelte-g9x8pv"> </strong></p>'),ut=m('<strong class="svelte-g9x8pv"> </strong> and <strong class="svelte-g9x8pv"> </strong>',1),ct=m('<strong class="svelte-g9x8pv"> </strong><!><!>',1),ft=m('<p class="svelte-g9x8pv">You are equally suited for <!></p>'),dt=m('<h2 class="svelte-g9x8pv">Conclusion</h2> <!>',1),_t=m('<div class="results-container svelte-g9x8pv"><h1 class="svelte-g9x8pv"> </h1> <div class="results-grid svelte-g9x8pv"></div> <div class="conclusion svelte-g9x8pv"><!></div> <div class="action-buttons svelte-g9x8pv"><button class="restart-button svelte-g9x8pv">Start Over</button> <button class="share-button svelte-g9x8pv">Share Results</button></div></div>');function gt(o,x){we(x,!1);let p=ie(x,"topicResults",28,()=>({})),j=ie(x,"onRestart",8),d=ie(x,"answerHistory",24,()=>[]),S=ie(x,"surveyName",8,"Survey");const I=()=>{const q=Math.max(...Object.values(p()).map(u=>u.count)),_=Object.entries(p()).filter(([u,L])=>L.count===q).map(([u])=>u);let g=`I just completed the "${S()}" survey!

`;_.length===1?g+=`My result: I am most suited for ${_[0]}

`:g+=`My result: I am equally suited for ${_.join(" and ")}

`,g+=`Take the survey yourself: ${window.location.href}`,navigator.share?navigator.share({title:`My ${S()} Results`,text:g,url:window.location.href}).catch(u=>{navigator.clipboard.writeText(g)}):navigator.clipboard.writeText(g)};Je(()=>(xe(p()),xe(d())),()=>{const q=Object.values(p()).reduce((_,g)=>_+g,0);p(Object.entries(p()).reduce((_,[g,u])=>(_[g]={count:u,percentage:q>0?Math.round(u/q*100):0,answers:d().filter(L=>L.topics.includes(g))},_),{}))}),We(),me();var R=_t(),l=c(R),t=c(l),a=w(l,2);ne(a,5,()=>Object.entries(p()),ve,(q,_)=>{let g=()=>e(_)[0],u=()=>e(_)[1];var L=lt(),F=c(L),W=c(F),v=w(F,4),P=c(v),B=w(v,2),n=c(B),f=w(B,2),b=w(c(f),2);{var M=N=>{var C=vt();ne(C,5,()=>u().answers,ve,(G,V)=>{var J=nt(),O=c(J),D=c(O),K=w(O,2),X=c(K);z(()=>{T(D,e(V).question),T(X,`You chose: ${e(V).answer??""}`)}),h(G,J)}),h(N,C)},H=N=>{var C=it();h(N,C)};Q(b,N=>{u().answers.length>0?N(M):N(H,!1)})}z(()=>{tt(L,"style",`--percentage: ${u().percentage??""}%`),T(W,g()),T(P,`${u().percentage??""}%`),T(n,`(${u().count??""} points)`)}),h(q,L)});var r=w(a,2),s=c(r);{var y=q=>{var _=dt();const g=ue(()=>Math.max(...Object.values(p()).map(v=>v.count))),u=ue(()=>Object.entries(p()).filter(([v,P])=>P.count===e(g)).map(([v])=>v));var L=w(se(_),2);{var F=v=>{var P=ot(),B=w(c(P)),n=c(B);z(()=>T(n,e(u)[0])),h(v,P)},W=v=>{var P=ft(),B=w(c(P));{var n=b=>{var M=ut(),H=se(M),N=c(H),C=w(H,2),G=c(C);z(()=>{T(N,e(u)[0]),T(G,e(u)[1])}),h(b,M)},f=b=>{var M=qe(),H=se(M);ne(H,1,()=>e(u),ve,(N,C,G)=>{var V=ct(),J=se(V),O=c(J),D=w(J);{var K=k=>{var te=ye(",");h(k,te)};Q(D,k=>{G<e(u).length-2&&k(K)})}var X=w(D);{var $=k=>{var te=ye("and");h(k,te)};Q(X,k=>{G===e(u).length-2&&k($)})}z(()=>T(O,e(C))),h(N,V)}),h(b,M)};Q(B,b=>{e(u).length===2?b(n):b(f,!1)})}h(v,P)};Q(L,v=>{e(u).length===1?v(F):v(W,!1)})}h(q,_)};Q(s,q=>{Object.entries(p()).length>0&&q(y)})}var E=w(r,2),U=c(E),A=w(U,2);z(()=>T(t,`Your Results for "${S()??""}"`)),re("click",U,function(...q){var _;(_=j())==null||_.apply(this,q)}),re("click",A,I),h(o,R),Se()}var ht=m('<div class="loading svelte-5x38qi">Loading...</div>'),xt=m('<div class="error svelte-5x38qi"><p> </p> <button class="svelte-5x38qi">Dismiss</button></div>'),yt=m('<button class="survey-button svelte-5x38qi"> </button>'),pt=m('<div class="survey-list svelte-5x38qi"></div>'),bt=m("<p>No surveys available. Please add some surveys first.</p>"),wt=m('<div class="survey-selection svelte-5x38qi"><h2 class="svelte-5x38qi">Select a Decision Aid</h2> <!></div>'),mt=m('<button class="svelte-5x38qi"> </button>'),St=m('<div class="question-container svelte-5x38qi"><h3 class="svelte-5x38qi"> </h3> <h2 class="svelte-5x38qi"> </h2> <div class="button-container svelte-5x38qi"></div> <div class="progress svelte-5x38qi"> </div></div>'),qt=m('<div class="no-questions svelte-5x38qi"><p>No questions available for this survey.</p> <button class="svelte-5x38qi">Select Another Survey</button></div>'),Rt=m('<div class="main-content svelte-5x38qi"><!></div>'),Pt=m('<main class="svelte-5x38qi"><!> <!> <!></main>');function Et(o,x){we(x,!1);let p=Z([]),j=Z(null),d=null,S=Z([]),I=Z(0),R=Z(),l=Z({}),t=Z(!1),a=Z([]),r=Z(!1),s=Z(null);Xe(async()=>{const f=new URLSearchParams(window.location.search).get("survey");if(f)try{await E(f)}catch{i(s,"Failed to load the requested survey."),await y()}else await y()});const y=async()=>{try{i(r,!0),i(p,await at()),i(r,!1)}catch(n){console.error("Error loading surveys:",n),i(s,"Failed to load surveys. Please try again later."),i(r,!1)}},E=async n=>{try{i(r,!0);const f=await rt(n),b=await st(n);if(!f||!b||b.length===0)throw new Error("Survey not found or has no questions");d=n,i(j,f),i(S,b),i(I,0),i(R,e(S)[e(I)]),i(l,(f.topics||[]).reduce((M,H)=>(M[H]=0,M),{})),i(r,!1)}catch(f){throw console.error("Error loading survey:",f),i(r,!1),f}},U=async n=>{try{await E(n.id);const f=new URL(window.location);f.searchParams.set("survey",n.id),window.history.pushState({},"",f)}catch{i(s,"Failed to load the selected survey.")}},A=(n,f)=>{e(a).push({question:e(R).question,answer:f,topics:n}),n.forEach(b=>{$e(l,e(l)[b]++)}),q()},q=()=>{e(I)<e(S).length-1?(et(I),i(R,e(S)[e(I)])):i(t,!0)},_=()=>{i(j,null),d=null,i(t,!1),i(S,[]),i(I,0),i(R,null),i(a,[]),i(l,{});const n=new URL(window.location);n.searchParams.delete("survey"),window.history.pushState({},"",n)};me();var g=Pt(),u=c(g);{var L=n=>{var f=ht();h(n,f)};Q(u,n=>{e(r)&&n(L)})}var F=w(u,2);{var W=n=>{var f=xt(),b=c(f),M=c(b),H=w(b,2);z(()=>T(M,e(s))),re("click",H,()=>i(s,null)),h(n,f)};Q(F,n=>{e(s)&&n(W)})}var v=w(F,2);{var P=n=>{var f=ue(()=>{var b;return(b=e(j))==null?void 0:b.name});gt(n,{get topicResults(){return e(l)},onRestart:_,get answerHistory(){return e(a)},get surveyName(){return e(f)}})},B=n=>{var f=qe(),b=se(f);{var M=N=>{var C=wt(),G=w(c(C),2);{var V=O=>{var D=pt();ne(D,5,()=>e(p),ve,(K,X)=>{var $=yt(),k=c($);z(()=>T(k,e(X).name)),re("click",$,()=>U(e(X))),h(K,$)}),h(O,D)},J=O=>{var D=bt();h(O,D)};Q(G,O=>{e(p).length>0?O(V):O(J,!1)})}h(N,C)},H=N=>{var C=Rt(),G=c(C);{var V=O=>{var D=St(),K=c(D),X=c(K),$=w(K,2),k=c($),te=w($,2);ne(te,5,()=>e(R).buttons,ve,(Oe,ce)=>{var fe=mt(),Ie=c(fe);z(()=>T(Ie,e(ce).text)),re("click",fe,()=>A(e(ce).selectedTopics,e(ce).text)),h(Oe,fe)});var Re=w(te,2),Pe=c(Re);z(()=>{T(X,`Survey: ${e(j).name??""}`),T(k,e(R).question),T(Pe,`Question ${e(I)+1} of ${e(S).length??""}`)}),h(O,D)},J=O=>{var D=qt(),K=w(c(D),2);re("click",K,_),h(O,D)};Q(G,O=>{e(R)?O(V):O(J,!1)})}h(N,C)};Q(b,N=>{e(j)?N(H,!1):N(M)},!0)}h(n,f)};Q(v,n=>{e(t)?n(P):n(B,!1)})}h(o,g),Se()}export{Et as default};
