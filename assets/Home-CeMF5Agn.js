import{S as ie,o as Ee,a as qe,s as ee,b as Ne,c as l,U as F,g as oe,d as e,e as de,f as Ae,h as Le,i as Te,j as je,p as De,L as Me,P as Ce,k as Fe,u as _e,B as Ye,R as Ue,l as ge,m as Be,n as He,q as Qe,r as Ge,t as Ke,v as he,w as ue,x as Ze,y as ze,z as Ve,A as we,C as Je,D as ye,E as We,F as me,G as H,H as z,I as re,J as h,K as Se,M as m,N as w,O as c,Q as L,T as se,V as Re,W as xe,X as Xe,Y as Z,Z as $e,_ as et}from"./index-CtMulDBz.js";import{e as ne,s as tt,i as ve,g as at,a as rt,b as st}from"./databaseService-DpeqZkc3.js";function ae(o,y=null,p){if(typeof o!="object"||o===null||ie in o)return o;const T=Le(o);if(T!==Ee&&T!==qe)return o;var d=new Map,S=Te(o),k=ee(0);S&&d.set("length",ee(o.length));var P;return new Proxy(o,{defineProperty(i,t,a){(!("value"in a)||a.configurable===!1||a.enumerable===!1||a.writable===!1)&&Ne();var r=d.get(t);return r===void 0?(r=ee(a.value),d.set(t,r)):l(r,ae(a.value,P)),!0},deleteProperty(i,t){var a=d.get(t);if(a===void 0)t in i&&d.set(t,ee(F));else{if(S&&typeof t=="string"){var r=d.get("length"),s=Number(t);Number.isInteger(s)&&s<r.v&&l(r,s)}l(a,F),pe(k)}return!0},get(i,t,a){var E;if(t===ie)return o;var r=d.get(t),s=t in i;if(r===void 0&&(!s||(E=oe(i,t))!=null&&E.writable)&&(r=ee(ae(s?i[t]:F,P)),d.set(t,r)),r!==void 0){var x=e(r);return x===F?void 0:x}return Reflect.get(i,t,a)},getOwnPropertyDescriptor(i,t){var a=Reflect.getOwnPropertyDescriptor(i,t);if(a&&"value"in a){var r=d.get(t);r&&(a.value=e(r))}else if(a===void 0){var s=d.get(t),x=s==null?void 0:s.v;if(s!==void 0&&x!==F)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return a},has(i,t){var x;if(t===ie)return!0;var a=d.get(t),r=a!==void 0&&a.v!==F||Reflect.has(i,t);if(a!==void 0||de!==null&&(!r||(x=oe(i,t))!=null&&x.writable)){a===void 0&&(a=ee(r?ae(i[t],P):F),d.set(t,a));var s=e(a);if(s===F)return!1}return r},set(i,t,a,r){var g;var s=d.get(t),x=t in i;if(S&&t==="length")for(var E=a;E<s.v;E+=1){var Y=d.get(E+"");Y!==void 0?l(Y,F):E in i&&(Y=ee(F),d.set(E+"",Y))}s===void 0?(!x||(g=oe(i,t))!=null&&g.writable)&&(s=ee(void 0),l(s,ae(a,P)),d.set(t,s)):(x=s.v!==F,l(s,ae(a,P)));var N=Reflect.getOwnPropertyDescriptor(i,t);if(N!=null&&N.set&&N.set.call(r,a),!x){if(S&&typeof t=="string"){var R=d.get("length"),_=Number(t);Number.isInteger(_)&&_>=R.v&&l(R,_+1)}pe(k)}return!0},ownKeys(i){e(k);var t=Reflect.ownKeys(i).filter(s=>{var x=d.get(s);return x===void 0||x.v!==F});for(var[a,r]of d)r.v!==F&&!(a in i)&&t.push(a);return t},setPrototypeOf(){Ae()}})}function pe(o,y=1){l(o,o.v+y)}function be(o){for(var y=de,p=de;y!==null&&!(y.f&(Ye|Ue));)y=y.parent;try{return ge(y),o()}finally{ge(p)}}function le(o,y,p,T){var W;var d=(p&Be)!==0,S=!He||(p&Qe)!==0,k=(p&Ge)!==0,P=(p&ze)!==0,i=!1,t;k?[t,i]=je(()=>o[y]):t=o[y];var a=ie in o||Ke in o,r=((W=oe(o,y))==null?void 0:W.set)??(a&&k&&y in o?v=>o[y]=v:void 0),s=T,x=!0,E=!1,Y=()=>(E=!0,x&&(x=!1,P?s=_e(T):s=T),s);t===void 0&&T!==void 0&&(r&&S&&De(),t=Y(),r&&r(t));var N;if(S)N=()=>{var v=o[y];return v===void 0?Y():(x=!0,E=!1,v)};else{var R=be(()=>(d?he:ue)(()=>o[y]));R.f|=Me,N=()=>{var v=e(R);return v!==void 0&&(s=void 0),v===void 0?s:v}}if(!(p&Ce))return N;if(r){var _=o.$$legacy;return function(v,O){return arguments.length>0?((!S||!O||_||i)&&r(O?N():v),v):N()}}var g=!1,u=!1,A=Ze(t),C=be(()=>he(()=>{var v=N(),O=e(A);return g?(g=!1,u=!0,O):(u=!1,A.v=v)}));return d||(C.equals=Fe),function(v,O){if(Ve!==null&&(g=u,N(),e(A)),arguments.length>0){const U=O?e(C):S&&k?ae(v):v;return C.equals(U)||(g=!0,l(A,U),E&&s!==void 0&&(s=U),_e(()=>e(C))),v}return e(C)}}var nt=m('<li class="svelte-g9x8pv"><p class="question-text svelte-g9x8pv"> </p> <p class="answer-text svelte-g9x8pv"> </p></li>'),vt=m('<ul class="svelte-g9x8pv"></ul>'),lt=m('<p class="no-answers svelte-g9x8pv">No answers for this topic</p>'),it=m('<div class="result-card svelte-g9x8pv"><h2 class="svelte-g9x8pv"> </h2> <div class="percentage-bar svelte-g9x8pv"><div class="percentage-fill svelte-g9x8pv"></div></div> <p class="percentage-text svelte-g9x8pv"> </p> <p class="points-text svelte-g9x8pv"> </p> <div class="answers-section svelte-g9x8pv"><h3 class="svelte-g9x8pv">Supporting Answers:</h3> <!></div></div>'),ot=m('<p class="svelte-g9x8pv">You are most suited for <strong class="svelte-g9x8pv"> </strong></p>'),ut=m('<strong class="svelte-g9x8pv"> </strong> and <strong class="svelte-g9x8pv"> </strong>',1),ct=m('<strong class="svelte-g9x8pv"> </strong><!><!>',1),ft=m('<p class="svelte-g9x8pv">You are equally suited for <!></p>'),dt=m('<h2 class="svelte-g9x8pv">Conclusion</h2> <!>',1),_t=m('<div class="results-container svelte-g9x8pv"><h1 class="svelte-g9x8pv"> </h1> <div class="results-grid svelte-g9x8pv"></div> <div class="conclusion svelte-g9x8pv"><!></div> <div class="action-buttons svelte-g9x8pv"><button class="restart-button svelte-g9x8pv">Start Over</button> <button class="share-button svelte-g9x8pv">Share Results</button></div></div>');function gt(o,y){we(y,!1);let p=le(y,"topicResults",28,()=>({})),T=le(y,"onRestart",8),d=le(y,"answerHistory",24,()=>[]),S=le(y,"surveyName",8,"Survey");const k=()=>{const R=Math.max(...Object.values(p()).map(u=>u.count)),_=Object.entries(p()).filter(([u,A])=>A.count===R).map(([u])=>u);let g=`I just completed the "${S()}" survey!

`;_.length===1?g+=`My result: I am most suited for ${_[0]}

`:g+=`My result: I am equally suited for ${_.join(" and ")}

`,g+=`Take the survey yourself: ${window.location.href}`,navigator.share?navigator.share({title:`My ${S()} Results`,text:g,url:window.location.href}).catch(u=>{navigator.clipboard.writeText(g)}):navigator.clipboard.writeText(g)};Je(()=>(ye(p()),ye(d())),()=>{const R=Object.values(p()).reduce((_,g)=>_+g,0);p(Object.entries(p()).reduce((_,[g,u])=>(_[g]={count:u,percentage:R>0?Math.round(u/R*100):0,answers:d().filter(A=>A.topics.includes(g))},_),{}))}),We(),me();var P=_t(),i=c(P),t=c(i),a=w(i,2);ne(a,5,()=>Object.entries(p()),ve,(R,_)=>{let g=()=>e(_)[0],u=()=>e(_)[1];var A=it(),C=c(A),W=c(C),v=w(C,4),O=c(v),U=w(v,2),n=c(U),f=w(U,2),b=w(c(f),2);{var D=q=>{var M=vt();ne(M,5,()=>u().answers,ve,(G,V)=>{var J=nt(),I=c(J),j=c(I),K=w(I,2),X=c(K);z(()=>{L(j,e(V).question),L(X,`You chose: ${e(V).answer??""}`)}),h(G,J)}),h(q,M)},B=q=>{var M=lt();h(q,M)};H(b,q=>{u().answers.length>0?q(D):q(B,!1)})}z(()=>{tt(A,"style",`--percentage: ${u().percentage??""}%`),L(W,g()),L(O,`${u().percentage??""}%`),L(n,`(${u().count??""} points)`)}),h(R,A)});var r=w(a,2),s=c(r);{var x=R=>{var _=dt();const g=ue(()=>Math.max(...Object.values(p()).map(v=>v.count))),u=ue(()=>Object.entries(p()).filter(([v,O])=>O.count===e(g)).map(([v])=>v));var A=w(se(_),2);{var C=v=>{var O=ot(),U=w(c(O)),n=c(U);z(()=>L(n,e(u)[0])),h(v,O)},W=v=>{var O=ft(),U=w(c(O));{var n=b=>{var D=ut(),B=se(D),q=c(B),M=w(B,2),G=c(M);z(()=>{L(q,e(u)[0]),L(G,e(u)[1])}),h(b,D)},f=b=>{var D=Re(),B=se(D);ne(B,1,()=>e(u),ve,(q,M,G)=>{var V=ct(),J=se(V),I=c(J),j=w(J);{var K=Q=>{var te=xe(",");h(Q,te)};H(j,Q=>{G<e(u).length-2&&Q(K)})}var X=w(j);{var $=Q=>{var te=xe("and");h(Q,te)};H(X,Q=>{G===e(u).length-2&&Q($)})}z(()=>L(I,e(M))),h(q,V)}),h(b,D)};H(U,b=>{e(u).length===2?b(n):b(f,!1)})}h(v,O)};H(A,v=>{e(u).length===1?v(C):v(W,!1)})}h(R,_)};H(s,R=>{Object.entries(p()).length>0&&R(x)})}var E=w(r,2),Y=c(E),N=w(Y,2);z(()=>L(t,`Your Results for "${S()??""}"`)),re("click",Y,function(...R){var _;(_=T())==null||_.apply(this,R)}),re("click",N,k),h(o,P),Se()}var ht=m('<div class="loading svelte-195lk2a">Loading...</div>'),yt=m('<div class="error svelte-195lk2a"><p> </p> <button class="svelte-195lk2a">Dismiss</button></div>'),xt=m('<button class="survey-button svelte-195lk2a"> </button>'),pt=m('<div class="survey-list svelte-195lk2a"></div>'),bt=m("<p>No surveys available. Please add some surveys first.</p>"),wt=m('<div class="survey-selection svelte-195lk2a"><h2 class="svelte-195lk2a">Select a Decision Aid</h2> <!></div>'),mt=m('<button class="svelte-195lk2a"> </button>'),St=m('<div class="question-container svelte-195lk2a"><h3 class="svelte-195lk2a"> </h3> <h2 class="svelte-195lk2a"> </h2> <div class="button-container svelte-195lk2a"></div> <div class="progress svelte-195lk2a"> </div></div>'),Rt=m('<div class="no-questions svelte-195lk2a"><p>No questions available for this survey.</p> <button class="svelte-195lk2a">Select Another Survey</button></div>'),Pt=m('<div class="main-content svelte-195lk2a"><!></div>'),Ot=m('<main class="svelte-195lk2a"><!> <!> <!></main>');function Et(o,y){we(y,!1);let p=Z([]),T=Z(null),d=null,S=Z([]),k=Z(0),P=Z(),i=Z({}),t=Z(!1),a=Z([]),r=Z(!1),s=Z(null);Xe(async()=>{const f=new URLSearchParams(window.location.search).get("survey");if(f)try{await E(f)}catch{l(s,"Failed to load the requested survey."),await x()}else await x()});const x=async()=>{try{l(r,!0),l(p,await at()),l(r,!1)}catch(n){console.error("Error loading surveys:",n),l(s,"Failed to load surveys. Please try again later."),l(r,!1)}},E=async n=>{try{l(r,!0);const f=await rt(n),b=await st(n);if(!f||!b||b.length===0)throw new Error("Survey not found or has no questions");d=n,l(T,f),l(S,b),l(k,0),l(P,e(S)[e(k)]),l(i,(f.topics||[]).reduce((D,B)=>(D[B]=0,D),{})),l(r,!1)}catch(f){throw console.error("Error loading survey:",f),l(r,!1),f}},Y=async n=>{try{await E(n.id);const f=new URL(window.location);f.searchParams.set("survey",n.id),window.history.pushState({},"",f)}catch{l(s,"Failed to load the selected survey.")}},N=(n,f)=>{e(a).push({question:e(P).question,answer:f,topics:n}),n.forEach(b=>{$e(i,e(i)[b]++)}),R()},R=()=>{e(k)<e(S).length-1?(et(k),l(P,e(S)[e(k)])):l(t,!0)},_=()=>{l(T,null),d=null,l(t,!1),l(S,[]),l(k,0),l(P,null),l(a,[]),l(i,{});const n=new URL(window.location);n.searchParams.delete("survey"),window.history.pushState({},"",n)};me();var g=Ot(),u=c(g);{var A=n=>{var f=ht();h(n,f)};H(u,n=>{e(r)&&n(A)})}var C=w(u,2);{var W=n=>{var f=yt(),b=c(f),D=c(b),B=w(b,2);z(()=>L(D,e(s))),re("click",B,()=>l(s,null)),h(n,f)};H(C,n=>{e(s)&&n(W)})}var v=w(C,2);{var O=n=>{var f=ue(()=>{var b;return(b=e(T))==null?void 0:b.name});gt(n,{get topicResults(){return e(i)},onRestart:_,get answerHistory(){return e(a)},get surveyName(){return e(f)}})},U=n=>{var f=Re(),b=se(f);{var D=q=>{var M=wt(),G=w(c(M),2);{var V=I=>{var j=pt();ne(j,5,()=>e(p),ve,(K,X)=>{var $=xt(),Q=c($);z(()=>L(Q,e(X).name)),re("click",$,()=>Y(e(X))),h(K,$)}),h(I,j)},J=I=>{var j=bt();h(I,j)};H(G,I=>{e(p).length>0?I(V):I(J,!1)})}h(q,M)},B=q=>{var M=Pt(),G=c(M);{var V=I=>{var j=St(),K=c(j),X=c(K),$=w(K,2),Q=c($),te=w($,2);ne(te,5,()=>e(P).buttons,ve,(Ie,ce)=>{var fe=mt(),ke=c(fe);z(()=>L(ke,e(ce).text)),re("click",fe,()=>N(e(ce).selectedTopics,e(ce).text)),h(Ie,fe)});var Pe=w(te,2),Oe=c(Pe);z(()=>{L(X,`Survey: ${e(T).name??""}`),L(Q,e(P).question),L(Oe,`Question ${e(k)+1} of ${e(S).length??""}`)}),h(I,j)},J=I=>{var j=Rt(),K=w(c(j),2);re("click",K,_),h(I,j)};H(G,I=>{e(P)?I(V):I(J,!1)})}h(q,M)};H(b,q=>{e(T)?q(B,!1):q(D)},!0)}h(n,f)};H(v,n=>{e(t)?n(O):n(U,!1)})}h(o,g),Se()}export{Et as default};
