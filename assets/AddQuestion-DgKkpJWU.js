import{A as lt,$ as ot,X as nt,c as t,C as vt,E as ct,F as ut,G as L,d as e,J as o,K as dt,M as v,a0 as $e,Y as u,O as r,N as s,I as n,V as Me,Q as xe,a1 as Ce,H as te,T as z,a2 as U,Z as pt,a3 as _t,a4 as Le}from"./index-C1TeO9iK.js";import{g as ft,e as ae,i as se,b as we,d as yt,s as Oe,c as mt,f as bt,u as qt,h as ht,j as gt}from"./databaseService-ldi9NRwe.js";var xt=v('<div class="loading svelte-1qrp95a">Loading...</div>'),wt=v('<div class="survey-item svelte-1qrp95a"><span class="survey-name svelte-1qrp95a"> </span> <div class="survey-actions svelte-1qrp95a"><button class="svelte-1qrp95a">Edit</button> <button class="delete svelte-1qrp95a">Delete</button> <button class="share svelte-1qrp95a">Copy Link</button></div></div>'),kt=v('<div class="existing-surveys svelte-1qrp95a"><h3 class="svelte-1qrp95a">Existing Surveys</h3> <!></div>'),St=v('<div class="survey-management svelte-1qrp95a"><h2 class="svelte-1qrp95a">Survey Management</h2> <button class="create-new svelte-1qrp95a">Create New Survey</button> <!></div>'),At=v('<div class="survey-name-form svelte-1qrp95a"><button class="back-button svelte-1qrp95a">← Back to Survey List</button> <div class="survey-section svelte-1qrp95a"><h2 class="svelte-1qrp95a">Enter Survey Name</h2> <input type="text" placeholder="Enter survey name" class="svelte-1qrp95a"> <button class="svelte-1qrp95a">Submit Survey Name</button></div></div>'),Tt=v('<input type="text" class="svelte-1qrp95a">'),Et=v('<div class="topics-form svelte-1qrp95a"><button class="back-button svelte-1qrp95a">← Back to Survey List</button> <div class="topics-section svelte-1qrp95a"><h2 class="svelte-1qrp95a">How many topics would you like to add? (2-10)</h2> <input type="number" min="2" max="10" class="svelte-1qrp95a"> <h3 class="svelte-1qrp95a">Enter Your Topics</h3> <!> <button class="svelte-1qrp95a">Submit Topics</button></div></div>'),Qt=v('<div class="question-item svelte-1qrp95a"><span class="question-text svelte-1qrp95a"> </span> <div class="question-actions svelte-1qrp95a"><button class="svelte-1qrp95a">Edit</button> <button class="delete svelte-1qrp95a">Delete</button></div></div>'),Nt=v('<h3 class="svelte-1qrp95a">Questions</h3> <!>',1),$t=v('<p class="no-questions svelte-1qrp95a">No questions added yet.</p>'),Mt=v('<div class="existing-questions svelte-1qrp95a"><button class="create-new svelte-1qrp95a">Add New Question</button> <!></div>'),Ct=v('<label class="svelte-1qrp95a"><input type="checkbox" class="svelte-1qrp95a"> </label>'),Lt=v('<div class="button-options svelte-1qrp95a"><h4 class="svelte-1qrp95a"></h4> <input type="text" class="svelte-1qrp95a"> <div class="topic-checkboxes svelte-1qrp95a"><p class="svelte-1qrp95a">Select associated topics:</p> <!></div></div>'),Ot=v('<div class="add-question-container svelte-1qrp95a"><button class="back-button svelte-1qrp95a">← Back to Questions</button> <h2 class="svelte-1qrp95a"> </h2> <input type="text" placeholder="Enter your question" class="svelte-1qrp95a"> <div class="options-count svelte-1qrp95a"><h3 class="svelte-1qrp95a">Number of options for this question:</h3> <input type="number" min="2" max="10" class="svelte-1qrp95a"></div> <div class="button-container svelte-1qrp95a"></div> <button class="svelte-1qrp95a"> </button></div>'),Bt=v('<div class="question-management svelte-1qrp95a"><button class="back-button svelte-1qrp95a">← Back to Survey List</button> <h2 class="svelte-1qrp95a"> </h2> <div class="survey-link svelte-1qrp95a"><p>Share this link with others:</p> <div class="link-container svelte-1qrp95a"><input type="text" readonly="" class="svelte-1qrp95a"> <button class="svelte-1qrp95a">Copy</button></div></div> <!></div>'),Dt=v('<main class="svelte-1qrp95a"><!> <!></main>');function Pt(Be,De){lt(De,!1);const ke=ot(),_e=()=>$e(Y,"$areTopicsAdded",ke),Fe=()=>$e(j,"$isSurveyNameAdded",ke);let y=u(""),h=u(2),c=u([]),g=u(""),x=u(2),Q=u([]),re=u([]),fe=null,p=u(null),ie=u(!1),O=u([]),m=u(!1),l=u(!1),Y=Ce(!1),j=Ce(!1),le=u(!0),ye=null,w=u(null);nt(async()=>{await me()});const me=async()=>{try{t(l,!0),t(re,await ft()),t(l,!1)}catch(a){console.error("Error loading surveys:",a),t(l,!1)}},He=a=>{t(w,a.id),t(g,a.question),t(x,a.buttons.length),t(Q,a.buttons.map(i=>{const k=new Array(e(c).length).fill(!1);return i.selectedTopics.forEach(N=>{const B=e(c).indexOf(N);B!==-1&&(k[B]=!0)}),{text:i.text,selectedTopics:k}})),t(m,!0),ye=a},Pe=()=>{t(le,!1),t(ie,!1),j.set(!1),Y.set(!1),t(y,""),fe=null,t(p,null),t(h,2),oe()},ze=async a=>{try{t(l,!0),t(p,a.id),fe=a.name,t(y,a.name),t(ie,!0),t(le,!1),j.set(!0),Y.set(!0),t(c,a.topics||[]),t(O,await we(e(p))),t(m,!1),t(l,!1)}catch(i){console.error("Error editing survey:",i),t(l,!1)}},Ue=()=>{t(m,!e(m)),e(m)&&(t(g,""),G())},Ye=async a=>{if(confirm(`Are you sure you want to delete the survey "${a.name}"?`))try{t(l,!0),await yt(a.id),await me(),t(l,!1)}catch(i){console.error("Error deleting survey:",i),t(l,!1)}},je=async a=>{if(confirm("Are you sure you want to delete this question?"))try{t(l,!0),await gt(a),t(O,await we(e(p))),t(l,!1)}catch(i){console.error("Error deleting question:",i),t(l,!1)}},oe=()=>{t(h,Math.max(2,Math.min(10,e(h)))),t(c,new Array(e(h)).fill(""))},G=()=>{t(Q,Array(e(x)).fill().map(()=>({text:"",selectedTopics:new Array(e(c).length).fill(!1)})))},Ge=()=>{if(!e(y).trim()){alert("Please enter a survey name");return}if(e(re).some(a=>a.name===e(y))){alert("A survey with this name already exists");return}j.set(!0)},Ie=async()=>{if(e(c).length>10){alert("Maximum number of topics is 10"),oe();return}if(e(c).every(a=>a.trim()!==""))try{t(l,!0);const a={name:e(y),topics:e(c)};t(p,await bt(a)),Y.set(!0),t(O,[]),G(),t(l,!1)}catch(a){console.error("Error adding topics:",a),t(l,!1)}else alert("Please enter all topics")},Je=async()=>{if(e(g)&&e(Q).every(a=>a.text&&a.selectedTopics.some(i=>i)))try{t(l,!0);const a={question:e(g),buttons:e(Q).map(i=>({text:i.text,selectedTopics:e(c).filter((k,N)=>i.selectedTopics[N])}))};e(w)?await qt(e(w),a):await ht(e(p),a),t(O,await we(e(p))),t(g,""),t(w,null),ye=null,G(),t(m,!1),t(l,!1)}catch(a){console.error(e(w)?"Error updating question:":"Error adding question:",a),t(l,!1)}else alert("Please fill in all fields and select at least one topic per button")},Ke=()=>{t(g,""),t(w,null),ye=null,G(),t(m,!1)},Ve=()=>{t(h,Math.max(2,Math.min(10,e(h)))),oe()},Xe=()=>{e(x)<2&&t(x,2),e(x)>10&&t(x,10),G()},be=()=>{t(le,!0),t(ie,!1),j.set(!1),Y.set(!1),fe=null,t(p,null),t(m,!1),me()};vt(()=>_e(),()=>{_e()||oe()}),ct(),ut();var Se=Dt(),Ae=r(Se);{var Ze=a=>{var i=xt();o(a,i)};L(Ae,a=>{e(l)&&a(Ze)})}var Re=s(Ae,2);{var We=a=>{var i=St(),k=s(r(i),2),N=s(k,2);{var B=_=>{var S=kt(),D=s(r(S),2);ae(D,1,()=>e(re),se,(I,b)=>{var d=wt(),f=r(d),$=r(f),F=s(f,2),A=r(F),T=s(A,2),J=s(T,2);te(()=>z($,e(b).name)),n("click",A,()=>ze(e(b))),n("click",T,()=>Ye(e(b))),n("click",J,()=>navigator.clipboard.writeText(`${window.location.origin}?survey=${e(b).id}`)),o(I,d)}),o(_,S)};L(N,_=>{e(re).length>0&&_(B)})}n("click",k,Pe),o(a,i)},et=a=>{var i=Me(),k=xe(i);{var N=_=>{var S=At(),D=r(S),I=s(D,2),b=s(r(I),2),d=s(b,2);n("click",D,be),U(b,()=>e(y),f=>t(y,f)),n("click",d,Ge),o(_,S)},B=_=>{var S=Me(),D=xe(S);{var I=d=>{var f=Et(),$=r(f),F=s($,2),A=s(r(F),2),T=s(A,4);ae(T,1,()=>e(c),se,(H,Te,K)=>{var V=Tt();Oe(V,"placeholder",`Enter topic ${K+1}`),U(V,()=>e(c)[K],qe=>pt(c,e(c)[K]=qe)),o(H,V)});var J=s(T,2);n("click",$,be),U(A,()=>e(h),H=>t(h,H)),n("input",A,Ve),n("click",J,Ie),o(d,f)},b=d=>{var f=Bt(),$=r(f),F=s($,2),A=r(F),T=s(F,2),J=s(r(T),2),H=r(J),Te=s(H,2),K=s(T,2);{var V=P=>{var X=Mt(),Z=r(X),ne=s(Z,2);{var he=q=>{var M=Nt(),ce=s(xe(M),2);ae(ce,1,()=>e(O),se,(ue,R)=>{var E=Qt(),C=r(E),de=r(C),pe=s(C,2),W=r(pe),ee=s(W,2);te(()=>z(de,e(R).question)),n("click",W,()=>He(e(R))),n("click",ee,()=>je(e(R).id)),o(ue,E)}),o(q,M)},ve=q=>{var M=$t();o(q,M)};L(ne,q=>{e(O).length>0?q(he):q(ve,!1)})}n("click",Z,Ue),o(P,X)},qe=P=>{var X=Ot(),Z=r(X),ne=s(Z,2),he=r(ne),ve=s(ne,2),q=s(ve,2),M=s(r(q),2),ce=s(q,2);ae(ce,5,()=>e(Q),se,(E,C,de)=>{var pe=Lt(),W=r(pe);W.textContent=`Option ${de+1}`;var ee=s(W,2);Oe(ee,"placeholder",`Option ${de+1} text`);var tt=s(ee,2),at=s(r(tt),2);ae(at,1,()=>e(c),se,(ge,st,Ee)=>{var Qe=Ct(),Ne=r(Qe),rt=s(Ne);te(()=>z(rt,` ${e(st)??""}`)),_t(Ne,()=>e(C).selectedTopics[Ee],it=>(e(C).selectedTopics[Ee]=it,Le(()=>e(Q)))),o(ge,Qe)}),U(ee,()=>e(C).text,ge=>(e(C).text=ge,Le(()=>e(Q)))),o(E,pe)});var ue=s(ce,2),R=r(ue);te(()=>{z(he,`${(e(w)?"Edit":"Add a New")??""} Question for "${e(y)??""}"`),z(R,`${(e(w)?"Update":"Add")??""} Question`)}),n("click",Z,Ke),U(ve,()=>e(g),E=>t(g,E)),U(M,()=>e(x),E=>t(x,E)),n("input",M,Xe),n("click",ue,Je),o(P,X)};L(K,P=>{e(m)?P(qe,!1):P(V)})}te(()=>{z(A,`Survey: ${e(y)??""}`),mt(H,`${window.location.origin}?survey=${e(p)}`)}),n("click",$,be),n("click",Te,()=>navigator.clipboard.writeText(`${window.location.origin}?survey=${e(p)}`)),o(d,f)};L(D,d=>{!_e()&&!e(ie)?d(I):d(b,!1)},!0)}o(_,S)};L(k,_=>{Fe()?_(B,!1):_(N)},!0)}o(a,i)};L(Re,a=>{e(le)?a(We):a(et,!1)})}o(Be,Se),dt()}export{Pt as default};
